SEED: 40244023
MODEL:
  META_ARCHITECTURE: "Detr"
  WEIGHTS: "detectron2://ImageNetPretrained/FAIR/X-101-32x8d.pkl"
  PIXEL_STD: [57.375, 57.120, 58.395]
  MASK_ON: False
  BACKBONE:
    NAME: "build_resnet_fpn_backbone"
  RESNETS:
    STRIDE_IN_1X1: False  # this is a C2 model
    NUM_GROUPS: 32
    WIDTH_PER_GROUP: 8
    DEPTH: 101
    OUT_FEATURES: ["res2", "res3", "res4", "res5"]
  FPN:
    IN_FEATURES: ["res2", "res3", "res4", "res5"]
  ROI_HEADS:
    IN_FEATURES: ["p2", "p3", "p4", "p5"]
  ROI_BOX_HEAD:
    POOLER_TYPE: "ROIAlignV2"
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
  DETR:
    NUM_CLASSES: 80
    ENC_LAYERS: 0
    DEC_LAYERS: 6  # ablation.
    CONV_SHARED: False  # better. // keep it False.
    NUM_CONV: 0
    FC_SHARED: False  # keep it False // fc_shared not implement now
    NUM_CLS: 1
    NUM_REG: 3
    NHEADS: 8
    DROPOUT: 0.1
    DIM_FEEDFORWARD: 2048
    HIDDEN_DIM: 256
    CLASS_WEIGHT: 2.0
    GIOU_WEIGHT: 2.0
    L1_WEIGHT: 5.0
    NO_OBJECT_WEIGHT: 0.1
    DEEP_SUPERVISION: True
    NUM_OBJECT_QUERIES: 300  # ablation.
    USE_L1: True
    USE_FOCAL: True
    DROP_POS: True
    DYNAMIC_ON: True
    TYPE_DYNAMIC: "plain"
    VIEW_ON: True
    DIM_DYNAMIC: 64
    BOX_TUNED: True
    BOX_WEIGHTS: [(1.0, 1.0, 1.0, 1.0),
                  (1.0, 1.0, 1.0, 1.0),
                  (1.0, 1.0, 1.0, 1.0),
                  (1.0, 1.0, 1.0, 1.0),
                  (1.0, 1.0, 1.0, 1.0),
                  (1.0, 1.0, 1.0, 1.0)]
    ANCHOR_TYPE: "random"
DATASETS:
  TRAIN: ("coco_2017_train",)
  TEST: ("coco_2017_val",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.000025
  STEPS: (280000, 333300)
  MAX_ITER: 360000
  WARMUP_FACTOR: 0.01
  WARMUP_ITERS: 1000
  WEIGHT_DECAY: 0.0001
  OPTIMIZER: "ADAMW"
  BACKBONE_MULTIPLIER: 1.  # keep same with BASE_LR.
  CLIP_GRADIENTS:  # Do not use Gradient clipping.
    ENABLED: True
    CLIP_TYPE: "full_model"
    CLIP_VALUE: 1.0
    NORM_TYPE: 2.0
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  CROP:
    ENABLED: False
    TYPE: "absolute_range"
    SIZE: (384, 600)
TEST:
  EVAL_PERIOD: 7330
DATALOADER:
  FILTER_EMPTY_ANNOTATIONS: False
  NUM_WORKERS: 4
VERSION: 2
